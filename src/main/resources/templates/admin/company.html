<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org"
      xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8"/>
    <link rel="icon" type="image/x-icon" th:href="@{/icon/my.ico}" />
    <title>商家信息管理 </title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link th:href="@{/admin/assets/css/bootstrap.min.css}" rel="stylesheet"/>
    <link rel="stylesheet" th:href="@{/admin/assets/css/font-awesome.min.css}"/>
    <link rel="stylesheet" th:href="@{/admin/assets/css/ace.min.css}"/>
    <link rel="stylesheet" th:href="@{/admin/assets/css/ace-rtl.min.css}"/>
    <link rel="stylesheet" th:href="@{/admin/assets/css/ace-skins.min.css}"/>
    <link rel="stylesheet" th:href="@{/admin/css/style.css}"/>

    <script th:src="@{/admin/assets/js/ace-extra.min.js}"></script>
    <script th:src="@{/admin/js/jquery-1.9.1.min.js}"></script>
    <script th:src="@{/admin/assets/js/bootstrap.min.js}"></script>
    <script th:src="@{/admin/assets/js/typeahead-bs2.min.js}"></script>
    <script th:src="@{/admin/assets/js/ace-elements.min.js}"></script>
    <script th:src="@{/admin/assets/js/ace.min.js}"></script>
    <script th:src="@{/admin/assets/layer/layer.js}" type="text/javascript"></script>
    <script th:src="@{/admin/assets/laydate/laydate.js}" type="text/javascript"></script>


</head>

<body>
<div th:include="admin/index_top"></div>

<div class="main-content" style="margin-bottom: 100px">
    <!-- Infomation_header -->
    <div class="breadcrumbs">
        <ul class="breadcrumb">
            <li>
                <i class="icon-home home-icon"></i>
                <a th:href="@{/admin/index}">首页</a>
            </li>
        </ul>
    </div>
    <!-- /Infomation_header -->

    <!-- Infomation_main -->
    <div class="clearfix">
        <div class="admin_info_style">
            <div class="admin_modify_style" id="Personal" style="width: 100%">
                <div class="type_title">商家信息</div>
                <div class="xinxi">
                    <div class="form-group"><label class="col-sm-3 control-label no-padding-right"
                                                   for="form-field-1">商家名： </label>
                        <div class="col-sm-9"><input type="text" name="商家名" id="compName" th:value="${company.compName}"
                                                     class="col-xs-7 text_info" disabled="disabled"></div>
                    </div>

                    <div class="form-group"><label class="col-sm-3 control-label no-padding-right"
                                                   for="form-field-1">地址： </label>
                        <div class="col-sm-9"><input type="text" name="地址" id="address1" th:value="${company.address1}"
                                                     class="col-xs-7 text_info" disabled="disabled"></div>
                    </div>

                    <div class="form-group"><label class="col-sm-3 control-label no-padding-right"
                                                   for="form-field-1">详细地址： </label>
                        <div class="col-sm-9"><input type="text" name="详细地址" id="address2"
                                                     th:value="${company.address2}"
                                                     class="col-xs-7 text_info" disabled="disabled"></div>
                    </div>

                    <div class="form-group"><label class="col-sm-3 control-label no-padding-right"
                                                   for="form-field-1">联系人1： </label>
                        <div class="col-sm-9"><input type="text" name="联系人1" id="phone1User"
                                                     th:value="${company.phone1User}"
                                                     class="col-xs-7 text_info" disabled="disabled"></div>
                    </div>

                    <div class="form-group"><label class="col-sm-3 control-label no-padding-right"
                                                   for="form-field-1">手机号码1： </label>
                        <div class="col-sm-9"><input type="text" name="手机号码1：" id="phone1" th:value="${company.phone1}"
                                                     class="col-xs-7 text_info" disabled="disabled"></div>
                    </div>
                    <div class="form-group"><label class="col-sm-3 control-label no-padding-right"
                                                   for="form-field-1">联系人2： </label>
                        <div class="col-sm-9"><input type="text" name="联系人2：" id="phone2User"
                                                     th:value="${company.phone2User}"
                                                     class="col-xs-7 text_info" disabled="disabled"></div>
                    </div>
                    <div class="form-group"><label class="col-sm-3 control-label no-padding-right"
                                                   for="form-field-1">手机号码2： </label>
                        <div class="col-sm-9"><input type="text" name="手机号码2：" id="phone2" th:value="${company.phone2}"
                                                     class="col-xs-7 text_info" disabled="disabled"></div>
                    </div>

                    <div class="form-group"><label class="col-sm-3 control-label no-padding-right"
                                                   for="form-field-1">电子邮箱： </label>
                        <div class="col-sm-9"><input type="text" name="电子邮箱：" id="email" th:value="${company.email}"
                                                     class="col-xs-7 text_info" disabled="disabled"></div>
                    </div>

                    <div class="form-group"><label class="col-sm-3 control-label no-padding-right"
                                                   for="form-field-1">底部批号： </label>
                        <div class="col-sm-9"><input type="text" name="底部批号：" id="batch" th:value="${company.batch}"
                                                     class="col-xs-7 text_info" disabled="disabled"></div>
                    </div>

                    <div class="form-group"><label class="col-sm-3 control-label no-padding-right"
                                                   for="form-field-1">高德定位： </label>
                        <div class="col-sm-9"><input type="text" name="高德定位：" id="gaode" th:value="${company.gaode}"
                                                     class="col-xs-7 text_info" disabled="disabled"></div>
                    </div>

                    <div class="Button_operation clearfix">
                        <button onclick="modify();" class="btn btn-danger radius" id="modify" type="button">修改信息
                        </button>
                        <button onclick="modifyno();" class="btn btn-danger radius" id="modifyno" type="button"
                                style="display: none">放弃修改
                        </button>
                        <button onclick="save_info();" class="btn btn-success radius" type="submit">保存修改</button>
                    </div>
                </div>
            </div>

        </div>
    </div>

</div>
<!--footer-->
<div class="footer_style" id="footerstyle">
    <p class="l_f" th:text="${'版权所有&copy;'+company.compName +'&nbsp;&nbsp;&nbsp;&nbsp;'+company.batch}"></p>
</div>
<!--/footer-->


<input type="hidden" th:value="${contextPath}" id="contextPath">
<script>
    //按钮点击事件
    function modify() {
        $('.text_info').attr("disabled", false);
        $('.text_info').addClass("add");
        document.getElementById("modify").style.display = "none";
        document.getElementById("modifyno").style.display = "";
        $('#Personal').find('.xinxi').addClass("hover");
        $('#Personal').find('.btn-success').css({'display': 'block'});
    };

    function modifyno() {
        $('.text_info').attr("disabled", true);
        $('.text_info').removeClass("add");
        document.getElementById("modify").style.display = "";
        document.getElementById("modifyno").style.display = "none";
        $('#Personal').find('.btn-success').css({'display': 'none'});

    };

    function save_info() {
        var num = 0;
        var str = "";
        $(".xinxi input[type$='text']").each(function (n) {
            if ($(this).val() == "") {

                layer.alert(str += "" + $(this).attr("name") + "不能为空！\r\n", {
                    title: '提示框',
                    icon: 0,
                });
                num++;
                return false;
            }
        });
        if (num > 0) {
            return false;
        }
        else {
            var compName = document.getElementById("compName").value;
            var address1 = document.getElementById("address1").value;
            var address2 = document.getElementById("address2").value;
            var phone1User = document.getElementById("phone1User").value;
            var phone1 = document.getElementById("phone1").value;
            var phone2User = document.getElementById("phone2User").value;
            var phone2 = document.getElementById("phone2").value;
            var email = document.getElementById("email").value;
            var batch = document.getElementById("batch").value;
            var gaode = document.getElementById("gaode").value;

            let contextPath = $('#contextPath').val()
            $.ajax({
                type: "get",// 请求方式
                url: contextPath+"/admin/saveCompany",
                async: true,
                data: {
                    "compName": compName,
                    "address1": address1,
                    "address2": address2,
                    "phone1User": phone1User,
                    "phone1": phone1,
                    "phone2User": phone2User,
                    "phone2": phone2,
                    "email": email,
                    "batch": batch,
                    "gaode": gaode
                },
                dataType: "json",// 设置返回数据类型
                success: function (sign) {
                    if (sign.valueOf() == "1") {
                        layer.alert('修改成功！', {
                            title: '提示框',
                            icon: 1,
                        });

                        $('.text_info').attr("disabled", true);
                        $('.text_info').removeClass("add");
                        document.getElementById("modify").style.display = "";
                        document.getElementById("modifyno").style.display = "none";
                        $('#Personal').find('.btn-success').css({'display': 'none'});
                        // layer.close(index);

                    } else {
                        layer.alert('修改失败！', {
                            title: '提示框',
                            icon: 2,
                        });
                    }
                },
                error: function (XMLHttpRequest, statusText) {
                    alert("系统异常!")
                }
            })
        }
    };


</script>

</body>
</html>

